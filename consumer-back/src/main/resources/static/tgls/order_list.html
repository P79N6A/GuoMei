<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <!-- Google Chrome Frame也可以让IE用上Chrome的引擎: -->
    <meta name="renderer" content="webkit">
    <!--国产浏览器高速模式-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="国美电器"/>
    <!-- 作者 -->
    <meta name="revised" content="国美电器.v3, 2019/05/01"/>
    <!-- 定义页面的最新版本 -->
    <meta name="description" content="网站简介"/>
    <!-- 网站简介 -->
    <meta name="keywords" content="搜索关键字，以半角英文逗号隔开"/>
    <title>穷在闹市出品</title>

    <!-- 公共样式 开始 -->
    <link rel="stylesheet" type="text/css" href="../../css/base.css">
    <link rel="stylesheet" type="text/css" href="../../css/iconfont.css">
    <script type="text/javascript" src="../../framework/jquery-1.11.3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../../layui/css/layui.css">
    <script type="text/javascript" src="../../layui/layui.js"></script>
    <!-- 滚动条插件 -->
    <link rel="stylesheet" type="text/css" href="../../css/jquery.mCustomScrollbar.css">
    <script src="../../framework/jquery-ui-1.10.4.min.js"></script>
    <script src="../../framework/jquery.mousewheel.min.js"></script>
    <script src="../../framework/jquery.mCustomScrollbar.min.js"></script>
    <script src="../../framework/cframe.js"></script><!-- 仅供所有子页面使用 -->
    <!-- 公共样式 结束 -->

    <style>
        .layui-table img {
            max-width: none;
        }
    </style>

</head>

<body>
<div class="cBody">
    <div class="console">
        <form class="layui-form" action="">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">订单号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="orderNo" id="orderNo" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">收货人</label>
                    <div class="layui-input-inline">
                        <input type="text" name="name" id="name" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <button type="button" class="layui-btn" id="serch" data-type="reload" style="margin-bottom: 6px">搜索</button>
            </div>
        </form>
    </div>

    <table class="layui-table" id="followTable" lay-filter="followTable">

    </table>

    <!-- layUI 分页模块 -->
    <!--<div id="pages"></div>-->
    <script>
        layui.use(['element', 'table', 'form'], function () {
            var $ = layui.jquery,
                element = layui.element,
                table = layui.table,
                form = layui.form;
                var pageSize = 1;   //每页显示的数量
                  var currentPageNo = 1;    //当前页数
                 table.render({
                    elem: "#followTable",
                    url: '/Orders/orderList/' + null + '/' + null,
                    id: 'orderTable',
                     request:{     ////请求携带的参数
                          pageName:'currentPageNo',    //页码参数名称
                          limitName: 'pageSize'     //每页数据量参数名称
                     },
                     response:{    //后台返回数据
                         countName: 'totalCount',  //数据总数的名称
                         dataName: 'data'        //数据
                     },
                     page: true,
                     limits: ['5', '10', '15'],//分页每页显示数据条数（页面选择）
                     cols: [[
                         {field: "orderNo", title: "订单编号"},
                         {field: "userName", title: "收货人"},
                         {field: "title", title: "购买商品"},
                         {field: "total", title: "金额"},
                         {field: "address", title: "收货地址"},
                         {field: "orderTime", title: "订单时间"},
                         {field: "status", title: "状态"},
                         {field: 'right', title: '操作', toolbar: '#barDemo'},
                     ]]
                 });
              //模糊查询
            var $ = layui.$, active =
                {
                    reload: function () {
                        var orderNo=$("#orderNo").val();
                        var name=$("#name").val();
                        //判读是否为空(防止传空)
                        if(orderNo==""){
                            orderNo=null;
                        }
                        if(name==""){
                            name=null;
                        }
                        if(orderNo==""&&name==""){
                            orderNo=null;
                            name=null;
                        }
                        table.reload('orderTable',{
                            page:{curr:1},
                            url:'/Orders/orderList/' + orderNo + '/' + name
                        });
                    }
                }
            //这个是用于创建点击事件的实例
            $('#serch').on('click',function () {
                var type = $(this).data('type');
                active[type] ? active[type].call(this) : '';
            });

            //监听工具条
            table.on('tool(followTable)', function (obj) {
                var data = obj.data ,//获取当前行数据
                    layEvent = obj.event;      //获得lay-event对应的值
            });
        });
        //页面
//         layui.use('laypage', function () {
//             var laypage = layui.laypage;
//             //总页数大于页码总数
//             laypage.render({
//                 elem: 'pages'
//                 , count: 100
//                 , layout: ['count', 'prev', 'page', 'next', 'limit', 'skip']
//                 , jump: function (obj) {
// //					      console.log(obj)
//                 }
//             });
//         });

        //修改规格
        function specificationsBut() {
            layui.use('layer', function () {
                var layer = layui.layer;
                //iframe层-父子操作
                layer.open({
                    type: 2,
                    area: ['70%', '60%'],
                    fixed: false, //不固定
                    maxmin: true,
                    content: 'specifications_list.html'
                });
            });

        }

        //修改按钮
        var updateFrame = null;

        function updateBut() {
            layui.use('layer', function () {
                var layer = layui.layer;
                //iframe层-父子操作
                updateFrame = layer.open({
                    title: "订单信息修改",
                    type: 2,
                    area: ['557px', '400px'],
                    scrollbar: false,	//默认：true,默认允许浏览器滚动，如果设定scrollbar: false，则屏蔽
                    maxmin: true,
                    content: 'order_update.html'
                });
            });
        }

    </script>


    <!--//监听提交-->
    <!--form.on('submit(formDemo)', function(data) {-->
    <!--var formData=data.field;-->
    <!--var orderNos=formData.orderNo;-->
    <!--var names=formdata.name;-->
    <!--alert(orderNos);-->
    <!--// var orderNo=$("#orderNo").val();-->
    <!--// var name=$("#name").val();-->
    <!--table.reload('orderTable',{-->
    <!--page: {-->
    <!--curr: 1 //重新从第 1 页开始-->
    <!--},where:{-->
    <!--name:names,-->
    <!--orderNo:orderNos-->
    <!--}-->
    <!--,url:'/Orders/orderList'-->
    <!--});-->
    <!--return false;-->
    <!--});-->

    <script type="text/html" id="barDemo">
        <button class="layui-btn layui-btn-xs" onclick="updateBut()">修改</button>
        <button class="layui-btn layui-btn-xs">删除</button>
    </script>

</div>
</body>
</html>